#!/bin/bash

if ! command -v mpg123 >/dev/null; then
  echo ""
  echo "‚ö†Ô∏è  'mpg123' is required to play the anthem."
  echo "   It seems to be missing from your system."
  echo ""
  echo "üõ†  Install it using Homebrew:"
  echo "   brew install mpg123"
  echo ""
  exit 1
fi

if [[ -f "${HOMEBREW_PREFIX}/share/kimigayo/mp3/kimigayo.mp3" ]]; then
  MP3_PATH="${HOMEBREW_PREFIX}/share/kimigayo/mp3/kimigayo.mp3"
else
  MP3_PATH="$(dirname "$0")/../mp3/kimigayo.mp3"
fi

if [[ "$1" == "--help" || "$1" == "-h" ]]; then
  cat <<EOF
kimigayo - A minimal CLI to play the Japanese national anthem

Usage:
  kimigayo [--help|-h]

Options:
  --help, -h    Show this help message

Note:
  'mpg123' is required. If not installed, use:
    brew install mpg123
EOF
  exit 0
fi

LYRICS="
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ                              ‚îÇ
  ‚îÇ    Ëãî  Â∑å  „Åï  ÂçÉ  Âêõ        ‚îÇ
  ‚îÇ    „ÅÆ  „Å®  „Åñ  ‰ª£  „Åå  ÂõΩ    ‚îÇ
  ‚îÇ    „ÇÄ  „Å™  „Çå  „Å´  ‰ª£  Ê≠å    ‚îÇ
  ‚îÇ    „Åô  „Çä  Áü≥  ÂÖ´  „ÅØ        ‚îÇ
  ‚îÇ    „Åæ  „Å¶  „ÅÆ  ÂçÉ            ‚îÇ
  ‚îÇ    „Åß          ‰ª£            ‚îÇ
  ‚îÇ                „Å´            ‚îÇ
  ‚îÇ                              ‚îÇ
  ‚îú‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚îÄ ‚î§
  ‚îÇ                              ‚îÇ
  ‚îÇ    Ëãî  Â§ß  Â∞è  ÂçÉ  Â§©        ‚îÇ
  ‚îÇ    „Åå  „Åç  „Åï  Âπ¥  Áöá  Áèæ    ‚îÇ
  ‚îÇ    „Å§  „Å™  „Å™  „Éª  Èôõ  ‰ª£    ‚îÇ
  ‚îÇ    „Åè  Â≤©  Áü≥  ÂÖ´  ‰∏ã  Ë™û    ‚îÇ
  ‚îÇ    „Åæ  „Å´  „Åå  ÂçÉ  „Åå  Ë®≥    ‚îÇ
  ‚îÇ    „Åß  „Å™      Âπ¥  Áîü        ‚îÇ
  ‚îÇ        „Å£      „Å®  „Åç        ‚îÇ
  ‚îÇ        „Å¶      Èï∑  „Å¶        ‚îÇ
  ‚îÇ                „Åè  „Çâ        ‚îÇ
  ‚îÇ                Á∂ö  „Å£        ‚îÇ
  ‚îÇ                „Åç  „Åó        ‚îÇ
  ‚îÇ                „Åæ  „ÇÉ        ‚îÇ
  ‚îÇ                „Åô  „Çã        ‚îÇ
  ‚îÇ                „Çà  „Åì        ‚îÇ
  ‚îÇ                „ÅÜ  „ÅÆ        ‚îÇ
  ‚îÇ                „Å´  ÊôÇ        ‚îÇ
  ‚îÇ                    ‰ª£        ‚îÇ
  ‚îÇ                    „Åå        ‚îÇ
  ‚îÇ                              ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
"

# Clear screen and hide cursor
clear
tput civis

# Display the lyrics (vertical-style layout)
echo -e "$LYRICS"

# Play the anthem (suppress all mpg123 output)
mpg123 "$MP3_PATH" >/dev/null 2>&1

# Clear screen and restore cursor
clear
tput cnorm
